<%= title "movie night ##{@movie_night}" %>

<p><strong>when: </strong><%= @movie_night.created_at.to_formatted_s(:short) %>

<% unless @users.empty? -%>
  <strong>who:</strong >
    <% for user in @users -%>
      <% if user != @users.last && user != @users[-2] -%>
        <%= user %>,
      <% elsif user == @users[-2] -%>
        <%= user %>
      <% else -%>
        and <%= user %>
      <% end -%>
    <% end -%>
  </p>
<% end -%>

<% unless @movies_towatch.empty? %>
  <h2>movies everybody want to watch</h2>
  <%= render :partial => 'movies/top' %>
  <%= render :partial => 'movies/show', :collection => @movies_towatch, :as => :movie %>
  <%= render :partial => 'movies/bottom' %>
<% else %>
  <h2>movies everybody want to watch</h2>
  <p>didn't find any...</p>
<% end %>



<% unless @users.empty? %>
  <% for user in @users %>
    <% unless @movies_seen.empty? %>
      <h2>movies <%= user %> want to watch, and others haven't seen</h2>
      <% movies = user.towatch_movies - (@movies_seen - user.towatch_movies) %>
      <%= render :partial => 'movies/top' %>
      <%= render :partial => 'movies/show', :collection => movies, :as => :movie %>
      <%= render :partial => 'movies/bottom' %>
    <% end %>
  <% end %>
<% end %>